{% extends "base.html" %}
{% block title %}Criterios{% endblock %}
{% block content %}

{# --- bloque de flashes --- #}
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
  
<div class="card">
  <div class="card-body">
    <h5 class="card-title">Criterios para Licitación {{ lic_id }}</h5>
    <a href="{{ url_for('criterios.create_criterio_route', lic_id=lic_id) }}" class="btn btn-success mb-3">Nuevo Criterio</a>
    <table class="table">
      <thead>
        <tr>
          <th>Nombre</th><th>Peso</th><th>Tipo</th><th>Fórmula</th><th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for c in criterios %}
        <tr>
          <td>{{ c.NombreCriterio }}</td>
          <td>{{ c.Peso }}</td>
          <td>{{ c.TipoCriterio }}</td>
          <td>{{ c.NombreFormula or '-' }}</td>
          <td>
            <a href="{{ url_for('criterios.edit_criterio_route', lic_id=lic_id, crit_id=c.id) }}" class="btn btn-sm btn-warning">Editar</a>
            <form method="post" action="{{ url_for('criterios.delete_criterio_route', lic_id=lic_id, crit_id=c.id) }}" style="display:inline">
              <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('¿Eliminar criterio?')">Borrar</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <a href="{{ url_for('licitaciones.edit_licitacion_route', lic_id=lic_id) }}" class="btn btn-secondary">Volver a Licitación</a>
  </div>
</div>
{% endblock %}
